{
  "tables": [
    {
      "tableName": "note_data",
      "fromModuleVersion": 0.2,
      "withMetadata": true,
      "generateId": true,
      "populateJsonWithId": true,
      "likeIndex": [
        {
          "fieldName": "title",
          "tOps": "ADD",
          "caseSensitive": false
        }
      ]
    },
    {
      "tableName": "note_type",
      "generateId": true,
      "fromModuleVersion": 1.0,
      "withMetadata": true,
      "populateJsonWithId": true,
      "uniqueIndex" : [
        {
          "fieldName" : "name",
          "tOps" : "ADD"
        }
      ],
      "likeIndex": [
        {
          "fieldName": "name",
          "tOps": "ADD",
          "caseSensitive": false
        }
      ]
    }
  ],
  "scripts": [
    {
      "run": "after",
      "snippet": "ALTER TABLE note_data ADD COLUMN temporary_type_id UUID REFERENCES note_type (id);CREATE OR REPLACE FUNCTION update_type_id()RETURNS TRIGGER AS $$BEGIN  NEW.temporary_type_id = NEW.jsonb->>'typeId';  RETURN NEW;END;$$ language 'plpgsql'; CREATE TRIGGER update_type_id  BEFORE INSERT OR UPDATE ON note_data  FOR EACH ROW EXECUTE PROCEDURE update_type_id();",
      "fromModuleVersion": "1.0"
    }
  ]
}
